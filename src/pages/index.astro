---
import Layout from '../layouts/Layout.astro';
import { contentfulClient } from '../lib/contentful';

// Fetch blog posts from Contentful
const entries = await contentfulClient.getEntries({
  content_type: 'blogPost', // Replace with your actual content type ID
});

const posts = entries.items.map((item) => ({
  title: item.fields.title,
  slug: item.fields.slug,
  date: new Date(item.fields.date).toLocaleDateString(),
  excerpt: item.fields.excerpt || item.fields.content.substring(0, 100) + '...',
}));

---

<Layout title="My Blog">
  <main>
    <h1>Welcome to My Blog</h1>
    <ul>
      {posts.map((post) => (
        <li>
          <h2><a href={`/blog/${post.slug}`}>{post.title}</a></h2>
          <p>Published on: {post.date}</p>
          <p>{post.excerpt}</p>
        </li>
      ))}
    </ul>
  </main>
</Layout>